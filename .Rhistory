wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_2000s_Temp-DO.xlsx")
d00.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
d00.2 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d00.1 <- d00.1[, c("Permit.No.", "Designated.Name", "HUC", "Reporting.Period", "Conc..1", "Conc..2", "conc..Minimum")]
names(d00.1) <- c("permit", "name", "huc", "date", "tempfmaxmonavg", "tempfmaxday", "domglmin")
head(d00.1)
head(d00.1)
head(d90.1b)
# DEQ temp and DO data
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_1990s_Temp-DO.xlsx")
d90.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
d90.2 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d90.3 <- readWorksheet(wb, sheet=getSheets(wb)[3], startRow=1)
d90.3
  # Parameter.Cd..VPRM.          Parameter.Cd.Desc..VPRMD.              units
# 1               00010 Temperature, Water Deg. Centigrade    Degrees Celsius
# 2               00011 Temperature, Water Deg. Fahrenheit Degrees Fahrenheit
# 3               00300             Oxygen, Dissolved (Do)               mg/L
names(d90.1) <- c("permit", "name", "huc", "date", "param", "descr", "min", "mean", "max", "disc")
d90.1$param <- recode(d90.1$param, c("00010", "00011"), c("tempc", "domgl"), FALSE)
d90.1 <- d90.1[d90.1$param=="tempc" | d90.1$param=="domgl", ]
d90.1$date <- as.Date(substring(d90.1$date, 1, 10), origin = "1989-12-31")
d90.1$min <- as.numeric(d90.1$min)
d90.1$mean <- as.numeric(d90.1$mean)
d90.1$max <- as.numeric(d90.1$max)
d90.1 <- d90.1[, c("permit", "name", "huc", "date", "param", "min", "mean", "max")]
long <- melt(d90.1, id.vars=c("permit", "name", "huc", "date", "param"), meas.vars=c("min", "mean", "max"))
d90.1b <- cast(long, permit + name + huc + date ~ param + variable, fun.aggregate=mean)
names(d90.2) <- c("permit", "name", "lat", "long")
library(reshape)
# DEQ temp and DO data
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_1990s_Temp-DO.xlsx")
d90.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
d90.2 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d90.3 <- readWorksheet(wb, sheet=getSheets(wb)[3], startRow=1)
d90.3
  # Parameter.Cd..VPRM.          Parameter.Cd.Desc..VPRMD.              units
# 1               00010 Temperature, Water Deg. Centigrade    Degrees Celsius
# 2               00011 Temperature, Water Deg. Fahrenheit Degrees Fahrenheit
# 3               00300             Oxygen, Dissolved (Do)               mg/L
names(d90.1) <- c("permit", "name", "huc", "date", "param", "descr", "min", "mean", "max", "disc")
d90.1$param <- recode(d90.1$param, c("00010", "00011"), c("tempc", "domgl"), FALSE)
d90.1 <- d90.1[d90.1$param=="tempc" | d90.1$param=="domgl", ]
d90.1$date <- as.Date(substring(d90.1$date, 1, 10), origin = "1989-12-31")
d90.1$min <- as.numeric(d90.1$min)
d90.1$mean <- as.numeric(d90.1$mean)
d90.1$max <- as.numeric(d90.1$max)
d90.1 <- d90.1[, c("permit", "name", "huc", "date", "param", "min", "mean", "max")]
long <- melt(d90.1, id.vars=c("permit", "name", "huc", "date", "param"), meas.vars=c("min", "mean", "max"))
d90.1b <- cast(long, permit + name + huc + date ~ param + variable, fun.aggregate=mean)
names(d90.2) <- c("permit", "name", "lat", "long")
head(d00.1)
head(d90.1b)
as.numeric(d00.1$date[1:6])
as.numeric(d90.1b$date[1:6])
as.Date(d00.1$date[1:6], origin="1989-12-31")
as.numeric(as.Date(d00.1$date[1:6], origin="1989-12-31"))
# C:\JVA\GLFC\People\Hinderer\TempDO.r
library(reshape)
# DEQ temp and DO data
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_1990s_Temp-DO.xlsx")
d90.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
d90.2 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d90.3 <- readWorksheet(wb, sheet=getSheets(wb)[3], startRow=1)
d90.3
  # Parameter.Cd..VPRM.          Parameter.Cd.Desc..VPRMD.              units
# 1               00010 Temperature, Water Deg. Centigrade    Degrees Celsius
# 2               00011 Temperature, Water Deg. Fahrenheit Degrees Fahrenheit
# 3               00300             Oxygen, Dissolved (Do)               mg/L
names(d90.1) <- c("permit", "name", "huc", "date", "param", "descr", "min", "mean", "max", "disc")
d90.1$param <- recode(d90.1$param, c("00010", "00011"), c("tempc", "domgl"), FALSE)
d90.1 <- d90.1[d90.1$param=="tempc" | d90.1$param=="domgl", ]
d90.1$huc <- as.numeric(d90.1$huc)
d90.1$date <- as.Date(substring(d90.1$date, 1, 10), origin = "1989-12-31")
d90.1$min <- as.numeric(d90.1$min)
d90.1$mean <- as.numeric(d90.1$mean)
d90.1$max <- as.numeric(d90.1$max)
d90.1 <- d90.1[, c("permit", "name", "huc", "date", "param", "min", "mean", "max")]
long <- melt(d90.1, id.vars=c("permit", "name", "huc", "date", "param"), meas.vars=c("min", "mean", "max"))
d90.1b <- cast(long, permit + name + huc + date ~ param + variable, fun.aggregate=mean)
names(d90.2) <- c("permit", "name", "lat", "long")
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_2000s_Temp-DO.xlsx")
d00.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
d00.2 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d00.1 <- d00.1[, c("Permit.No.", "Designated.Name", "HUC", "Reporting.Period", "Conc..1", "Conc..2", "conc..Minimum")]
names(d00.1) <- c("permit", "name", "huc", "date", "tempf_maxmonavg", "tempf_max", "domgl_min")
d00.1$date <- as.Date(d00.1$date, origin="1989-12-31")
d00.1$tempc_maxmonavg <- (d00.1$tempf_maxmonavg - 32) * 5/9
d00.1$tempc_max <- (d00.1$tempf_max - 32) * 5/9
d00.1 <- d00.1[, c("permit", "name", "huc", "date", "domgl_min", "tempc_maxmonavg", "tempc_max")
head(d00.1)
head(d90.1b)
d00.1$tempf_maxmonavg
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_2000s_Temp-DO.xlsx")
d00.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
d00.2 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d00.1 <- d00.1[, c("Permit.No.", "Designated.Name", "HUC", "Reporting.Period", "Conc..1", "Conc..2", "conc..Minimum")]
names(d00.1) <- c("permit", "name", "huc", "date", "tempf_maxmonavg", "tempf_max", "domgl_min")
d00.1$date <- as.Date(d00.1$date, origin="1989-12-31")
d00.1$domgl_min <- as.numeric(d00.1$domgl_min)
d00.1$tempc_maxmonavg <- (as.numeric(d00.1$tempf_maxmonavg) - 32) * 5/9
d00.1$tempc_max <- (as.numeric((d00.1$tempf_max) - 32) * 5/9
d00.1 <- d00.1[, c("permit", "name", "huc", "date", "domgl_min", "tempc_maxmonavg", "tempc_max")]
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_2000s_Temp-DO.xlsx")
d00.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
d00.2 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d00.1 <- d00.1[, c("Permit.No.", "Designated.Name", "HUC", "Reporting.Period", "Conc..1", "Conc..2", "conc..Minimum")]
names(d00.1) <- c("permit", "name", "huc", "date", "tempf_maxmonavg", "tempf_max", "domgl_min")
d00.1$date <- as.Date(d00.1$date, origin="1989-12-31")
d00.1$domgl_min <- as.numeric(d00.1$domgl_min)
d00.1$tempc_maxmonavg <- (as.numeric(d00.1$tempf_maxmonavg) - 32) * 5/9
d00.1$tempc_max <- (as.numeric(d00.1$tempf_max) - 32) * 5/9
d00.1 <- d00.1[, c("permit", "name", "huc", "date", "domgl_min", "tempc_maxmonavg", "tempc_max")]
head(d00.1)
head(d90.1b)
deq <- merge(d90.1b, d00.1, by=c("permit", "name", "huc", "date"), all=TRUE)
dim(deq)
head(deq)
head(deq)
summary(d90.1b)
summary(d00.1)
library(plyr)
?rbind.fill
deq <- rbind.fill(d90.1b, d00.1)
dim(d90.1b)
dim(d00.1)
dim(deq)
head(deq)
head(d00.2)
names(d00.2) <- c("permit", "name", "lat", "long")
cleanup()
library(reshape)
library(plyr)
# DEQ temp and DO data
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_1990s_Temp-DO.xlsx")
d90.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
loc90 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d90.3 <- readWorksheet(wb, sheet=getSheets(wb)[3], startRow=1)
d90.3
  # Parameter.Cd..VPRM.          Parameter.Cd.Desc..VPRMD.              units
# 1               00010 Temperature, Water Deg. Centigrade    Degrees Celsius
# 2               00011 Temperature, Water Deg. Fahrenheit Degrees Fahrenheit
# 3               00300             Oxygen, Dissolved (Do)               mg/L
names(d90.1) <- c("permit", "name", "huc", "date", "param", "descr", "min", "mean", "max", "disc")
d90.1$param <- recode(d90.1$param, c("00010", "00011"), c("tempc", "domgl"), FALSE)
d90.1 <- d90.1[d90.1$param=="tempc" | d90.1$param=="domgl", ]
d90.1$huc <- as.numeric(d90.1$huc)
d90.1$date <- as.Date(substring(d90.1$date, 1, 10), origin = "1989-12-31")
d90.1$min <- as.numeric(d90.1$min)
d90.1$mean <- as.numeric(d90.1$mean)
d90.1$max <- as.numeric(d90.1$max)
d90.1 <- d90.1[, c("permit", "name", "huc", "date", "param", "min", "mean", "max")]
long <- melt(d90.1, id.vars=c("permit", "name", "huc", "date", "param"), meas.vars=c("min", "mean", "max"))
d90.1b <- cast(long, permit + name + huc + date ~ param + variable, fun.aggregate=mean)
names(loc90) <- c("permit", "name", "lat", "long")
wb <- loadWorkbook("C:/JVA/GLFC/People/Hinderer/DEQ_2000s_Temp-DO.xlsx")
d00.1 <- readWorksheet(wb, sheet=getSheets(wb)[1], startRow=1)
loc00 <- readWorksheet(wb, sheet=getSheets(wb)[2], startRow=1)
d00.1 <- d00.1[, c("Permit.No.", "Designated.Name", "HUC", "Reporting.Period", "Conc..1", "Conc..2", "conc..Minimum")]
names(d00.1) <- c("permit", "name", "huc", "date", "tempf_maxmonavg", "tempf_max", "domgl_min")
d00.1$date <- as.Date(d00.1$date, origin="1989-12-31")
d00.1$domgl_min <- as.numeric(d00.1$domgl_min)
d00.1$tempc_maxmonavg <- (as.numeric(d00.1$tempf_maxmonavg) - 32) * 5/9
d00.1$tempc_max <- (as.numeric(d00.1$tempf_max) - 32) * 5/9
d00.1 <- d00.1[, c("permit", "name", "huc", "date", "domgl_min", "tempc_maxmonavg", "tempc_max")]
names(loc00) <- c("permit", "name", "lat", "long")
deq <- rbind.fill(d90.1b, d00.1)
rm(wb, d90.1, d90.3, d90.1b, long, d00.1)
ls()
head(deq)
head(loc00)
head(loc90)
loc00[duplicated(loc00$permit), ]
loc00$permit[duplicated(loc00$permit)]
unique(loc00$permit[duplicated(loc00$permit)])
loc00[loc00$permit %in% unique(loc00$permit[duplicated(loc00$permit)]), ]
# duplicated permit numbers with different lat/longs
loc00[loc90$permit %in% unique(loc90$permit[duplicated(loc90$permit)]), ]
loc00[loc00$permit %in% unique(loc00$permit[duplicated(loc00$permit)]), ]
stringin("rtf", ls("jvamisc"))
stringin
?cheap
?cheat
library(devtools)
setwd("C:/JVA/GitHub/jvamisc")
document()
document()
q()
